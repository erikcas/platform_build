From 5eb90ff5409e040f5a3ab756083931605ac7828c Mon Sep 17 00:00:00 2001
From: Erik Castricum <erikcas1972@gmail.com>
Date: Tue, 2 Jun 2015 17:50:09 +0200
Subject: [PATCH 1/7] build: fix kernel building

---
 core/envsetup.mk | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/core/envsetup.mk b/core/envsetup.mk
index 124a91b..62ce78d 100644
--- a/core/envsetup.mk
+++ b/core/envsetup.mk
@@ -199,8 +199,12 @@ endif
 
 ifeq (,$(strip $(OUT_DIR)))
 ifeq (,$(strip $(OUT_DIR_COMMON_BASE)))
+ifneq ($(TOPDIR),)
 OUT_DIR := $(TOPDIR)out
 else
+OUT_DIR := $(shell readlink -f .)/out
+endif
+else
 OUT_DIR := $(OUT_DIR_COMMON_BASE)/$(notdir $(PWD))
 endif
 endif
-- 
1.9.1

